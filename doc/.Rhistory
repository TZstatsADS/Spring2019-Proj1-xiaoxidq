rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 800,),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 800,xaxis_height = 400),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 80,xaxis_height = 40),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 50,xaxis_height = 40),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 50,xaxis_height = 600),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 50,xaxis_height = 300),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 600,xaxis_height = 300),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 60,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 60,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 60,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 80,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 50,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 100,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 200,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 30,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_width = 60,xaxis_height = 30),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_font_size = 3 ),
align='center')
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_font_size = 4 ),
align='center')
par(mfrow=c(1,2))
#wordcloud of 24hours reaction
corpus <- VCorpus(VectorSource(hm_data[hm_data$reflection_period=="24h",]$text))
happy_dtm_tfidf <- DocumentTermMatrix(corpus, control = list(weighting = function(x) weightTfIdf(x,normalize =FALSE), stopwords = TRUE))
happy_dtm_tfidf = removeSparseTerms(happy_dtm_tfidf, 0.99)
freq = data.frame(sort(colSums(as.matrix(happy_dtm_tfidf)), decreasing=TRUE))
wordcloud(rownames(freq), freq[,1], max.words=70,min.freq = 3, rot.per=0.3,random.order=FALSE,scale=c(4,0.2),use.r.layout=T,colors=brewer.pal(8,"Set1"))
#wordcloud of 3months reaction
corpus <- VCorpus(VectorSource(hm_data[hm_data$reflection_period=="3m",]$text))
happy_dtm_tfidf <- DocumentTermMatrix(corpus, control = list(weighting = function(x) weightTfIdf(x,normalize =FALSE), stopwords = TRUE))
happy_dtm_tfidf = removeSparseTerms(happy_dtm_tfidf, 0.99)
freq = data.frame(sort(colSums(as.matrix(happy_dtm_tfidf)), decreasing=TRUE))
wordcloud(rownames(freq), freq[,1], max.words=70,min.freq = 3, rot.per=0.3,random.order=FALSE,scale=c(4,0.2),use.r.layout=T,colors=brewer.pal(8,"Set1"))
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(labels=c(F,T),varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(4.1,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(4.1,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(labels=c(F,T),varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(4.1,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(labels=c(F,T),varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(varnames=c(F,F),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labels=c(F,T),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(labels=c(F,T),varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(labels=c(F,T),varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
mosaic(~predicted_category+gender,data=sel_data,highlighting="gender",,highlighting_fill=c("pink","lightblue","black"),labeling= labeling_border(labels=c(F,T),varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
m<-grid.grab()
mosaic(~predicted_category+parenthood,data=sel_data,highlighting="parenthood",,highlighting_fill=c("pink","lightblue"),labeling= labeling_border(varnames=c(F,T),rot_labels = c(0,90,90,0), just_labels = c("left", "right", "right", "right")),margins=unit(3,"lines"))
a<-grid.grab()
grid.arrange(m,a,ncol=2)
knitr::opts_chunk$set(echo = TRUE)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
grid.arrange(m,a,ncol=2)
## Summary emotions
happy.summary=tbl_df(sentence.data)%>%
group_by(country)%>%
summarise(
anger=mean(anger,na.rm=TRUE),
anticipation=mean(anticipation,na.rm=TRUE),
disgust=mean(disgust,na.rm=TRUE),
fear=mean(fear,na.rm=TRUE),
joy=mean(joy,na.rm=TRUE),
sadness=mean(sadness,na.rm=TRUE),
surprise=mean(surprise,na.rm=TRUE),
trust=mean(trust,na.rm=TRUE),
negative=mean(negative,na.rm=TRUE),
positive=mean(positive,na.rm=TRUE)
)
happy.summary<-happy.summary[happy.summary$country!="NA",]
countryname<-happy.summary$country
happy.summary<-data.matrix(happy.summary[,-1])
rownames(happy.summary)<-as.data.frame(countryname)[,1]
library(shiny)
div(d3heatmap(happy.summary, scale="none", colors= "Reds",
xaxis_font_size = 8,Rowv = FALSE,Colv=FALSE,show_grid=TRUE,yaxis_font_size = 4 ),
align='center')
